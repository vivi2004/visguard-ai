{"version":3,"file":"workerRunner.js","names":["Cause","Chunk","Context","Deferred","Effect","Either","Fiber","FiberId","pipe","Layer","Schema","Stream","Transferable","isWorkerError","WorkerError","PlatformRunnerTypeId","Symbol","for","PlatformRunner","GenericTag","CloseLatch","Reference","defaultValue","unsafeMake","none","layerCloseLatch","effect","make","fnUntraced","process","options","fiber","withFiberRuntime","succeed","platform","closeLatch","backing","start","fiberMap","Map","await","onExit","currentScheduler","scheduleTask","unsafeInterruptAsFork","id","void","forkScoped","run","portId","kind","data","span","get","interrupt","set","decode","flatMap","input","collector","unsafeMakeCollector","stream","isEffect","out","encodeOutput","provideService","Collector","payload","send","unsafeRead","runForEachChunk","chunk","undefined","toReadonlyArray","unsafeClear","forEach","andThen","withParentSpan","_tag","traceId","spanId","sampled","context","empty","uninterruptibleMask","restore","catchIf","error","encodeCause","fail","catchAllCause","cause","match","failureOrCause","onLeft","encodeError","onRight","ensuring","sync","delete","layer","scopedDiscard","provide","makeSerialized","schema","handlers","gen","scope","parseRequest","decodeUnknown","request","result","isLayer","buildWithScope","_","merge","provideContext","message","mapError","reason","serializeFailure","serializeSuccess","layerSerialized","launch","scopedWith","provideMerge"],"sources":["../../../src/internal/workerRunner.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}